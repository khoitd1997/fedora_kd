- block:
    - block:
        - name: add vscode rpm keys
          command: "{{item}}"
          with_items:
            - rpm --import https://packages.microsoft.com/keys/microsoft.asc
            - sh -c 'echo -e "[code]\nname=Visual Studio Code\nbaseurl=https://packages.microsoft.com/yumrepos/vscode\nenabled=1\ngpgcheck=1\ngpgkey=https://packages.microsoft.com/keys/microsoft.asc" > /etc/yum.repos.d/vscode.repo'
          args:
            warn: false

        - name: install vscode rpm package
          dnf:
            name: code
            state: latest
      become: true

    - name: install vscode extension
      command: sh "{{ playbook_dir }}/vscode/vscode_extension.sh"
      tags:
        - vscode_extension

    - name: configure vscode
      command: sh "{{ playbook_dir }}/vscode/vscode_configure.sh"
      tags:
        - vscode_conf

  tags:
    - vscode
    - development
